<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Mark Attendance</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 15px;
      background-color: #f9f9f9;
    }
    h2 {
      color: #007bff;
      text-align: center;
    }
    .top-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      margin-bottom: 15px;
    }
    select, input[type="date"], button {
      padding: 10px;
      margin: 5px 0;
      width: 100%;
      max-width: 100%;
      font-size: 16px;
    }
    .student-list {
      margin-top: 10px;
    }
    .student-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: white;
      margin-bottom: 8px;
      padding: 12px;
      border-radius: 8px;
      box-shadow: 0 1px 4px rgba(0,0,0,0.1);
    }
    .bottom-buttons {
      margin-top: 20px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    .back-btn {
      background-color: #6c757d;
      color: white;
    }
    .submit-btn {
      background-color: #28a745;
      color: white;
    }
    .mark-all-btn {
      background-color: #007bff;
      color: white;
    }
    button {
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    @media (min-width: 600px) {
      select, input[type="date"], button {
        max-width: 250px;
      }
    }
  </style>
</head>
<body>

  <h2>Mark Attendance</h2>

  <div class="top-bar">
    <select id="dayFilter">
      <option value="">-- Select Day --</option>
      <option value="Monday">Monday</option>
      <option value="Tuesday">Tuesday</option>
      <option value="Wednesday">Wednesday</option>
      <option value="Thursday">Thursday</option>
      <option value="Friday">Friday</option>
      <option value="Saturday">Saturday</option>
      <option value="Sunday">Sunday</option>
    </select>
    <input type="date" id="attendanceDate" />
  </div>

  <div class="student-list" id="studentList"></div>

  <div class="bottom-buttons">
    <button class="mark-all-btn" id="markAllBtn">Mark All Present</button>
    <button class="submit-btn" id="submitAttendanceBtn">Submit Attendance</button>
    <button class="back-btn" onclick="window.location.href='index.html'">Back</button>
  </div>

  <script>
    const studentListEl = document.getElementById('studentList');
    const dayFilter = document.getElementById('dayFilter');
    const attendanceDate = document.getElementById('attendanceDate');
    const attendanceBtn = document.getElementById('submitAttendanceBtn');

    function loadStudentsForDay(day) {
      const students = JSON.parse(localStorage.getItem('students') || '[]');
      const filtered = day ? students.filter(s => s.day === day) : students;

      studentListEl.innerHTML = '';
      filtered.forEach(student => {
        const div = document.createElement('div');
        div.className = 'student-item';
        div.innerHTML = `
          <span>${student.name}</span>
          <input type="checkbox" class="student-checkbox" data-id="${student.id}" />
        `;
        studentListEl.appendChild(div);
      });
    }

    dayFilter.addEventListener('change', () => {
      loadStudentsForDay(dayFilter.value);
    });

    document.getElementById('markAllBtn').addEventListener('click', () => {
      document.querySelectorAll('.student-checkbox').forEach(cb => cb.checked = true);
    });

    attendanceBtn.addEventListener('click', () => {
      const date = attendanceDate.value;
      if (!date) {
        alert('Please select a date');
        return;
      }

      const checkboxes = document.querySelectorAll('.student-checkbox');
      const attendance = {};
      checkboxes.forEach(cb => {
        attendance[cb.dataset.id] = cb.checked;
      });

      const allData = JSON.parse(localStorage.getItem('attendanceData') || '{}');
      allData[date] = attendance;
      localStorage.setItem('attendanceData', JSON.stringify(allData));
      alert('Attendance recorded!');
    });

    // Auto-load todayâ€™s date
    attendanceDate.valueAsDate = new Date();
  </script>

</body>
</html>
