<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Attendance</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f0f4f8;
      margin: 0;
      padding: 10px;
    }

    .top-bar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 10px;
    }

    .top-bar button {
      background-color: #007bff;
      color: white;
      padding: 6px 12px;
      border: none;
      border-radius: 5px;
      font-size: 14px;
      cursor: pointer;
    }

    h2 {
      font-size: 20px;
      color: #007bff;
      margin: 10px 0;
      text-align: center;
    }

    label, select, input[type="date"] {
      font-size: 14px;
      margin: 6px 0;
      width: 100%;
    }

    .filters {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin-bottom: 15px;
    }

    .student-list {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .student-card {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: white;
      padding: 12px;
      border-radius: 10px;
      box-shadow: 0 0 5px rgba(0,0,0,0.05);
    }

    .student-info {
      display: flex;
      flex-direction: column;
      font-size: 14px;
    }

    .student-info strong {
      font-size: 15px;
    }

    .student-card input[type="checkbox"] {
      transform: scale(1.2);
    }

    @media (min-width: 600px) {
      .filters {
        flex-direction: row;
        gap: 15px;
        justify-content: space-between;
      }

      .filters > div {
        flex: 1;
      }
    }
  </style>
</head>
<body>

  <div class="top-bar">
    <button onclick="history.back()">‚Üê Back</button>
    <h2>Mark Attendance</h2>
  </div>

  <div class="filters">
    <div>
      <label for="dayFilter">Select Day:</label>
      <select id="dayFilter" onchange="filterStudents()">
        <option value="All">All</option>
        <option value="Monday">Monday</option>
        <option value="Tuesday">Tuesday</option>
        <option value="Wednesday">Wednesday</option>
        <option value="Thursday">Thursday</option>
        <option value="Friday">Friday</option>
        <option value="Saturday">Saturday</option>
        <option value="Sunday">Sunday</option>
      </select>
    </div>

    <div>
      <label for="attendanceDate">Select Date:</label>
      <input type="date" id="attendanceDate" />
    </div>
  </div>

  <div class="student-list" id="studentList">
    <!-- Students will be listed here -->
  </div>

  <script>
    const studentsKey = 'students';
    const attendanceKey = 'attendance';

    document.addEventListener('DOMContentLoaded', () => {
      document.getElementById('attendanceDate').valueAsDate = new Date();
      filterStudents();
    });

    function filterStudents() {
      const selectedDay = document.getElementById('dayFilter').value;
      const studentListDiv = document.getElementById('studentList');
      studentListDiv.innerHTML = '';

      const students = JSON.parse(localStorage.getItem(studentsKey)) || [];
      const attendance = JSON.parse(localStorage.getItem(attendanceKey)) || {};
      const todayDate = document.getElementById('attendanceDate').value;

      const filtered = selectedDay === 'All'
        ? students
        : students.filter(s => s.day === selectedDay);

      filtered.forEach(student => {
        const studentId = student.id;
        const isPresent = attendance[todayDate]?.[studentId] || false;

        const card = document.createElement('div');
        card.className = 'student-card';

        const infoDiv = document.createElement('div');
        infoDiv.className = 'student-info';
        infoDiv.innerHTML = `
          <strong>${student.name}</strong>
          <span>${student.phone}</span>
          <span style="color: #555;">Day: ${student.day}</span>
        `;

        const checkbox = document.createElement('input');
        checkbox.type = 'checkbox';
        checkbox.checked = isPresent;
        checkbox.onchange = () => markAttendance(studentId, checkbox.checked);

        card.appendChild(infoDiv);
        card.appendChild(checkbox);
        studentListDiv.appendChild(card);
      });
    }

    function markAttendance(studentId, status) {
      const date = document.getElementById('attendanceDate').value;
      const attendance = JSON.parse(localStorage.getItem(attendanceKey)) || {};
      attendance[date] = attendance[date] || {};
      attendance[date][studentId] = status;
      localStorage.setItem(attendanceKey, JSON.stringify(attendance));
    }
  </script>

</body>
</html>
